<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Learn to develop OSLC applications</title><link rel="stylesheet" href="https://oslc.github.io/developing-oslc-applications/css/oslc.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/solid.css" integrity="sha384-QokYePQSOwpBDuhlHOsX0ymF6R/vLk/UQVz3WHa6wygxI5oGTmDTv8wahFOSspdm" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/fontawesome.css" integrity="sha384-vd1e11sR28tEK9YANUtpIOdjGW14pS87bUBuOIoBILVWLFnS+MCX9T6MMf0VdPGq" crossorigin="anonymous"><script src="https://oslc.github.io/developing-oslc-applications/js/lib/modernizr.js"></script><script>// add .mustard/.no-mustard css classes
Modernizr.addTest( 'mustard', 'querySelector' in document && 'localStorage' in window && 'addEventListener' in window );

Modernizr.load([{
  test: Modernizr.mustard,
  yep: 'https://oslc.github.io/developing-oslc-applications/css/oslc_enhanced.css'
}]);

</script></head><body><header class="header"><div class="flag"><div class="image"><button title="Main menu" role="button" aria-label="Toggle Navigation" data-toggle-class="primary-nav-is-open" data-toggle-target="body" class="navburger mustard-only"><span class="navburger-line top"></span><span class="navburger-line middle"></span><span class="navburger-line bottom"></span></button></div><div class="body"><a href="https://oslc.github.io/developing-oslc-applications/" class="flag image-link"><div class="image"><img src="https://oslc.github.io/developing-oslc-applications/img/logo-new-mobile.png" class="logo-img"></div><div class="body"><span class="logo-text"><abbr title="Open Services for Lifecycle Collaboration" class="oslc-name">OSLC</abbr><br><span class="project-name">Developer Guide</span></span></div></a></div></div></header><div class="sticky-footer-body off-canvas-wrap"><nav class="nav"><div class="menu primary"><div class="item desk-up"><a href="https://oslc.github.io/developing-oslc-applications/" class="image-link"><img src="https://oslc.github.io/developing-oslc-applications/img/logo-new-big.png"><span class="logo-text"><abbr title="Open Services for Lifecycle Collaboration" class="oslc-name">OSLC</abbr><span class="project-name">Developer Guide</span></span></a></div><ul class="items"><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/index.html">Tutorial Overview</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/overview_of_oslc.html">A brief overview of OSLC</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/running_the_examples.html">Downloading and starting the sample applications</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_0_implementing_a_provider.html">Part 1, turning Bugzilla into a provider of the Change Management OSLC specification</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_1_planning_partial_cm_provider.html">Part 1.1, Planning Partial CM Provider</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_2_providing_service_resources.html">Part 1.2, Providing Service Resources</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_3_intro_to_oslc4j.html">Part 1.3, Intro to Eclipse Lyo</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_4_ui_preview.html">Part 1.4, UI Preview</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_5_ui_selection.html">Part 1.5, UI Selection</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_6_ui_creation.html">Part 1.6, UI Creation</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_7_factory.html">Part 1.7, Factory</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_0_implementing_consumer.html">Part 2, Implementing Consumer</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_1_consumer_use_cases.html">Part 2.1, Consumer Use Cases</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_2_links_and_previews.html">Part 2.2, Links and Previews</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_3_delegatedUI.html">Part 2.3, DelegatedUI</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_4_notify_customers.html">Part 2.4, Notify Customers</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_5_automatic_bugs.html">Part 2.5, Automatic Bugs</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_6_wrapup.html">Part 2.6, Wrap up</a></li></ul><div><iframe src="https://duckduckgo.com/search.html?width=220&site=oslc.github.io/developing-oslc-applications/&prefill=Search DuckDuckGo&kn=1" style="overflow:hidden;margin:0 0 0 13px;padding:0;width:305px;height:40px;" frameborder="0"></iframe></div></div></nav><main class="main"><div class="card"><header class="header"><h1 class="title"></h1></header><section class="content"><div class="copy"><h1>Providing UI Previews</h1><p>Once you establish relationships between resources using links, you can enable a very useful form of integration known as <a href="https://open-services.net/resources/oslc-primer/#ui-preview">UI Preview</a>. When a user is viewing a resource in a web browser, they might see a list of links to related resources that are in another application. UI Preview makes it easy for them to learn about those resources in context and without leaving the web page that they are looking at. When users “hover” over a link with their mouse or focus on it, they can see a brief preview of that resource in a tool-tip or a pop-up window. </p>
<p>For all the details, see the <a href="https://archive.open-services.net/bin/view/Main/OslcCoreUiPreview.html">OSLC UI Preview specification</a>. (Don’t worry; this one is pretty short.)</p>
<p>In this section, we’ll explore how to make our Bugzilla Adapter into a provider of UI Previews. When a user sees a link to Change Requests, they can see a UI Preview as long as the application that is displaying that link is a UI Preview Consumer. Later in this tutorial, you’ll be able to see your UI Preview in the NinaCRM application, because NinaCRM will support UI Preview as a Consumer.</p>
<h2>Add UI Preview handling to the BugzillaChangeRequestService class</h2><p>In the <a href="1_3_intro_to_oslc4j">previous section</a> we explored how the <strong>BugzillaChangeRequestService</strong> class handles requests for collections of <strong>BugzillaChangeRequests</strong> or individual <strong>BugzillaChangeRequests</strong>.</p>
<p>To add UI Preview support, we will add two methods to the service:</p>
<ol>
<li>Provide an OSLC Compact Representation of a <strong>BugzillaChangeRequest</strong>. </li>
<li>Provide what is known as a small HTML preview of a <strong>BugzillaChangeRequest</strong>.</li>
</ol>
<h3>Provide the compact XML representation of a Bugzilla bug</h3><p>Open the file <code>BugzillaChangeRequestService.java</code> in the <strong>org.eclipse.lyo.oslc4j.bugzilla.servcies</strong> package and find the <code>getCompact()</code> method.</p>
<p>Note the <code>@Produces</code> annotation:</p>
<pre><code>@Produces({OslcMediaType.APPLICATION_X_OSLC_COMPACT_XML})</code></pre><p>As with other media types, OSLC4J will handle serialization to the correct media types.</p>
<p>The method first fetches the bug and converts it to a BugzillaChangeRequest:</p>
<pre><code>final Bug bug = BugzillaManager.getBugById(httpServletRequest, changeRequestId);</code></pre><p>Then, it copies the &quot;About&quot; and &quot;Title&quot; attributes:</p>
<pre><code>compact.setAbout(getAboutURI(productId + &quot;/changeRequests/&quot; + changeRequest.getIdentifier()));
compact.setTitle(changeRequest.getTitle());</code></pre><p>Then to help identify the source of the bug, we add the Bugzilla icon (from the server) to our compact representation:</p>
<pre><code>String iconUri = BugzillaManager.getBugzillaUri() + &quot;/images/favicon.ico&quot;;
compact.setIcon(new URI(iconUri));</code></pre><p>Now we’ll build two Preview objects, <code>smallPreview</code> and <code>largePreview</code>, and pointers to the <code>smallPreview()</code> and <code>largePreview()</code> services in <strong>BugzillaChangeRequestService</strong>:</p>
<pre><code>//Create and set attributes for OSLC preview resource
final Preview smallPreview = new Preview();
smallPreview.setHintHeight(&quot;11em&quot;);
smallPreview.setHintWidth(&quot;45em&quot;);
smallPreview.setDocument(new URI(compact.getAbout().toString() + &quot;/smallPreview&quot;));
compact.setSmallPreview(smallPreview);

//Use the HTML representation of a change request as the large preview as well
final Preview largePreview = new Preview();
largePreview.setHintHeight(&quot;20em&quot;);
largePreview.setHintWidth(&quot;45em&quot;);
largePreview.setDocument(new URI(compact.getAbout().toString() + &quot;/largePreview&quot;));
compact.setLargePreview(largePreview);</code></pre><p>And finally return the compact XML:</p>
<pre><code>return compact;</code></pre><p>As with many other methods, we needed to create the Compact and Preview objects and then let OSLC4J take care of serializing them to RDF.</p>
<h4>Viewing the compact XML representation of a bug.</h4><p>The following assumes the Bugzilla adapter is running at <code>localhost:8080/OSLC4JBugzilla</code></p>
<p>In Firefox or Chrome, open the Poster plugin.</p>
<p>for the <strong>URL</strong> field, type the URL for a single bug:</p>
<pre><code>http://localhost:8080/OSLC4JBugzilla/services/{productId}/changeRequests/{bugId}</code></pre><p>For example, with a product ID of <strong>1</strong> and a bug ID of <strong>10</strong>:</p>
<pre><code>http://localhost:8080/OSLC4JBugzilla/services/1/changeRequests/10</code></pre><p>For the <strong>User Auth</strong> fields, type your Bugzilla username and password.</p>
<p>On the Headers tab, for the <strong>Name</strong> type <code>Accept</code> and for the <strong>Value</strong> type the following:</p>
<pre><code>application/x-oslc-compact+xml</code></pre><p>Then, click <strong>Add/Change</strong> to add the <code>Accept</code> header.</p>
<p>Click <strong>Get</strong> to execute the HTTP GET method and you should receive OSLC compact XML representation of the bug. Examine the output to see how the <code>oslc:smallPreview</code> and <code>oslc:largePreview</code> resources are defined in the <code>oslc:Compact</code> resource.</p>
<p>If a consumer application wants to display a small or large preview of a <strong>BugzillaChangeRequest</strong>, the application can find the URLs to them using this <code>x-oslc-compact+xml</code> representation.</p>
<p>Now, let&#39;s set up the HTML for these previews.</p>
<h3>Creating a method and JSP template for UI Previews</h3><p>In the last section, the <code>getCompact()</code> method in the <strong>BugzillaChangeRequestService</strong> created preview resources pointing to <code>changeRequests/{id}/smallPreview</code> and <code>changeRequests/{id}/largePreview</code>.</p>
<p>Open the file <code>BugzillaChangeRequestService.java</code> in the <strong>org.eclipse.lyo.oslc4j.bugzilla.servcies</strong> package and find the <code>smallPreview()</code> method:</p>
<pre><code>@GET
@Path(&quot;{changeRequestId}/smallPreview&quot;)
@Produces({ MediaType.TEXT_HTML })
public void smallPreview(@PathParam(&quot;productId&quot;)       final String productId,
                         @PathParam(&quot;changeRequestId&quot;) final String changeRequestId) throws ServletException, IOException, URISyntaxException
{
    // Method code here
}</code></pre><p>The <code>smallPreview()</code> method first fetches the bug and converts it to a <strong>BugzillaChangeRequest</strong>:</p>
<pre><code>final Bug bug = BugzillaManager.getBugById(httpServletRequest, changeRequestId);</code></pre><p>Then, it sets some attributes and dispatches a JSP:</p>
<pre><code>BugzillaChangeRequest changeRequest = BugzillaChangeRequest.fromBug(bug);

changeRequest.setServiceProvider(
  ServiceProviderCatalogSingleton.getServiceProvider(
    httpServletRequest, 
    productId).getAbout());
changeRequest.setAbout(getAboutURI(productId + &quot;/changeRequests/&quot; + changeRequest.getIdentifier()));

final String bugzillaUri = BugzillaManager.getBugzillaUri().toString();
httpServletRequest.setAttribute(&quot;changeRequest&quot;, changeRequest);
httpServletRequest.setAttribute(&quot;bugzillaUri&quot;, bugzillaUri);

RequestDispatcher rd = httpServletRequest.getRequestDispatcher(&quot;/cm/changerequest_preview_small.jsp&quot;);
rd.forward(httpServletRequest,httpServletResponse);</code></pre><p>Now, let&#39;s look at that JSP template. Open the file <code>/src/webapp/cm/changerequest_preview_small.jsp</code> in <strong>org.eclipse.lyo.oslc4j.bugzilla</strong> and browse the contents. The code near the top extracts the fields we want from the Change Request:</p>
<pre><code>&lt;%
BugzillaChangeRequest changeRequest = (BugzillaChangeRequest)request.getAttribute(&quot;changeRequest&quot;);
String bugzillaUri = (String) request.getAttribute(&quot;bugzillaUri&quot;);

Date createdDate = (Date) changeRequest.getCreated(); 
SimpleDateFormat formatter = new SimpleDateFormat();
String created = formatter.format(createdDate);
Date modifiedDate = (Date) changeRequest.getModified();
String modified = formatter.format(modifiedDate);

Person assigneePerson = (Person) changeRequest.getContributors().get(0);
String assignee = &quot;Unknown&quot;;
if (assigneePerson != null)
    assignee = assigneePerson.getMbox();
%&gt;</code></pre><p>Then those fields are output in a small table:</p>
<pre><code>&lt;table class=&quot;edit_form&quot;&gt;
    &lt;tr&gt;
        &lt;th&gt;Status:&lt;/th&gt;
        &lt;td&gt;&lt;%= changeRequest.getStatus() %&gt;&lt;/td&gt;
        &lt;th&gt;Product:&lt;/th&gt;
        &lt;td&gt;&lt;%= changeRequest.getProduct() %&gt;&lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
        &lt;th&gt;Assignee:&lt;/th&gt;
        &lt;td&gt;&lt;%= assignee %&gt;&lt;/td&gt;
        &lt;th&gt;Component:&lt;/th&gt;
        &lt;td&gt;&lt;%= changeRequest.getComponent() %&gt;&lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
        &lt;th&gt;Priority:&lt;/th&gt;
        &lt;td&gt;&lt;%= changeRequest.getPriority() %&gt;&lt;/td&gt;
        &lt;th&gt;Version:&lt;/th&gt;
        &lt;td&gt;&lt;%= changeRequest.getVersion() %&gt;&lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
        &lt;th&gt;Reported:&lt;/th&gt;
        &lt;td&gt;&lt;%= created %&gt;&lt;/td&gt;
        &lt;th&gt;Modified:&lt;/th&gt;
        &lt;td&gt;&lt;%= modified %&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;</code></pre><p>The method <code>largePreview()</code> works in a similar manner and uses the JSP template <code>changerequest_preview_large.jsp</code>.</p>
<h4>Viewing the UI preview</h4><p>With the adapter running, in a web browser navigate to the following URL:</p>
<pre><code>http://localhost:8080/OSLC4JBugzilla/services/{productId}/changeRequests/{bugId}/smallPreview</code></pre><p>For example, with a product ID of <strong>1</strong> and a bug ID of <strong>10</strong>:</p>
<pre><code>http://localhost:8080/OSLC4JBugzilla/services/1/changeRequests/10/smallPreview</code></pre><p>You should see a small table with details about the bug, similar to this:</p>
<p><img src="http://open-services.net/uploads/resources/uipreview-html.png" alt="A small table of information about a bug in the browser"></p>
<p>Now, given a URI link to a resource, we can provide some human-readable and usable presentations for that link, including a quick peak into the Bug using UI Preview. Later in this tutorial we&#39;ll explore how other applications can discover and display these previews.</p>
<p><a href="1_5_ui_selection">Next: Part 1.5, UI Selection</a></p></div></section></div><a role="button" aria-label="Toggle Navigation" data-toggle-class="primary-nav-is-open" data-toggle-target="body" class="close-off-canvas"></a></main></div><footer class="footer"><p>Content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 US</a> | <a href="https://github.com/OSLC/developing-oslc-applications/edit/gh-pages/_harp/1_4_ui_preview.md" target="_blank" style="font-weight: bold"><i class="fas fa-pencil-alt"></i> Edit this page</a> | <a href="https://github.com/OSLC/developing-oslc-applications/issues">Report an issue</a> | <a href="https://open-services.net/" target="_blank">Open Services for Lifecycle Collaboration</a> <i class="fas fa-external-link-alt"></i></p></footer></body><script>window.site_url = 'https://oslc.github.io/developing-oslc-applications/';</script><script src="https://oslc.github.io/developing-oslc-applications/js/oslc.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-24416914-3', 'oslc.github.io');
ga('send', 'pageview');</script></html>