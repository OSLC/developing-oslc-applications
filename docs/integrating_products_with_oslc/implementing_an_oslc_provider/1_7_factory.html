<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Learn to develop OSLC applications</title><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="stylesheet" href="https://oslc.github.io/developing-oslc-applications/css/oslc.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/solid.css" integrity="sha384-QokYePQSOwpBDuhlHOsX0ymF6R/vLk/UQVz3WHa6wygxI5oGTmDTv8wahFOSspdm" crossorigin="anonymous"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/fontawesome.css" integrity="sha384-vd1e11sR28tEK9YANUtpIOdjGW14pS87bUBuOIoBILVWLFnS+MCX9T6MMf0VdPGq" crossorigin="anonymous"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400;1,600;1,700&amp;family=Roboto+Mono&amp;display=swap" crossorigin="anonymous"><script src="https://oslc.github.io/developing-oslc-applications/js/lib/modernizr.js"></script><link rel="stylesheet" href="https://oslc.github.io/developing-oslc-applications/css/oslc_enhanced.css"></head><body><header class="header"><div class="flag"><div class="image"><button title="Main menu" role="button" aria-label="Toggle Navigation" data-toggle-class="primary-nav-is-open" data-toggle-target="body" class="navburger mustard-only"><span class="navburger-line top"></span><span class="navburger-line middle"></span><span class="navburger-line bottom"></span></button></div><div class="body"><a href="https://oslc.github.io/developing-oslc-applications/" class="flag image-link"><div class="image"><img src="https://oslc.github.io/developing-oslc-applications/img/logo-new-mobile.png" class="logo-img"></div><div class="body"><span class="logo-text"><abbr title="Open Services for Lifecycle Collaboration" class="oslc-name">OSLC</abbr><br><span class="project-name">Developer Guide</span></span></div></a></div></div></header><div class="sticky-footer-body off-canvas-wrap"><nav class="nav"><div class="menu primary"><div class="item desk-up"><a href="https://oslc.github.io/developing-oslc-applications/" class="image-link"><img src="https://oslc.github.io/developing-oslc-applications/img/logo-new-big.png" width="100" height="100" class="logo"><span class="logo-text"><abbr title="Open Services for Lifecycle Collaboration" class="oslc-name">OSLC</abbr><span class="project-name">Developer Guide</span></span></a></div><ul class="items"><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/index.html">Tutorial Overview</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/overview_of_oslc.html">A brief overview of OSLC</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/running_the_examples.html">Downloading and starting the sample applications</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_0_implementing_a_provider.html">Part 1, turning Bugzilla into a provider of the Change Management OSLC specification</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_1_planning_partial_cm_provider.html">Part 1.1, Planning Partial CM Provider</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_2_providing_service_resources.html">Part 1.2, Providing Service Resources</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_3_intro_to_oslc4j.html">Part 1.3, Intro to Eclipse Lyo</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_4_ui_preview.html">Part 1.4, UI Preview</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_5_ui_selection.html">Part 1.5, UI Selection</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_6_ui_creation.html">Part 1.6, UI Creation</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/implementing_an_oslc_provider/1_7_factory.html">Part 1.7, Factory</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_0_implementing_consumer.html">Part 2, Implementing Consumer</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_1_consumer_use_cases.html">Part 2.1, Consumer Use Cases</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_2_links_and_previews.html">Part 2.2, Links and Previews</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_3_delegatedUI.html">Part 2.3, DelegatedUI</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_4_notify_customers.html">Part 2.4, Notify Customers</a></li><li role="presentation" class="item "><a href="https://oslc.github.io/developing-oslc-applications/integrating_products_with_oslc/integrating_with_an_oslc_provider/2_5_automatic_bugs.html">Part 2.5, Automatic Bugs</a></li></ul><div><iframe src="https://duckduckgo.com/search.html?width=220&site=oslc.github.io/developing-oslc-applications/&prefill=Search DuckDuckGo&kn=1" style="overflow:hidden;margin:0 0 0 13px;padding:0;width:305px;height:40px;" frameborder="0"></iframe></div></div></nav><main class="main"><div class="card"><header class="header"><h1 class="title"></h1></header><section class="content"><div class="copy"><h1>Providing a creation factory</h1><p>With OSLC you can <a href="1_6_ui_creation">allow people to create bugs via Delegated UI</a>; however, like all UI approaches, an actual human user must be involved. What if you want to support automated bug creation; for example, enabling a build server to automatically create a bug whenever there is a test or a build failure? </p>
<p>To allow clients to create new bugs automatically, you need to support an <a href="https://archive.open-services.net/bin/view/Main/OslcCoreSpecification.html#Creation_Factories">OSLC Creation Factory</a> as described in the <a href="https://archive.open-services.net/bin/view/Main/OslcCoreSpecification.html">OSLC Core specification</a>. </p>
<h2>Adding a method to the adapter to create BugzillaChangeRequests via HTTP POST</h2><p>Recall that when we created a delegated UI for creating new bugs, we wrote code in the <strong>BugzillaManager</strong> class to use the <strong>j2bugzilla</strong> API for creation of bugs; weâ€™ll re-use the <code>createBug()</code> method for automated bug creation via POST.</p>
<h3>Adding the Creation Factory to Service Provider documents</h3><p>Open the file <code>BugzillaChangeRequestService.java</code> in the <strong>org.eclipse.lyo.bugzilla.services</strong> package.</p>
<p>First search for the <code>@OslcCreationFactory</code> annotation: </p>
<pre><code>@OslcCreationFactory
(
  title = &quot;Change Request Creation Factory&quot;,
  label = &quot;Change Request Creation&quot;,
  resourceShapes = {OslcConstants.PATH_RESOURCE_SHAPES + &quot;/&quot; + Constants.PATH_CHANGE_REQUEST},
  resourceTypes = {Constants.TYPE_CHANGE_REQUEST},
  usages = {OslcConstants.OSLC_USAGE_DEFAULT}
)
</code></pre>
<p>Notice that we&#39;ve specified a <code>resourceShapes</code> location; we&#39;ll cover that in more detail below.</p>
<p>As with our other services, OSLC4J uses this annotation and automatically adds the URI for the creation factory to our XML and JSON Service Provider documents. (You will have to manually add it to the <code>serviceprovider_html.jsp</code> template to add it to the HTML representation.)</p>
<p>Because we haven&#39;t set any different path, the creation factory will be available at the root path of our <strong>BugzillaChangeRequestService</strong> class which is <code>{productId}/changeRequests</code>. For example, if your adapter is running at <code>localhost:8080</code> and the product ID is <code>1</code>, the creation factory will be at the following URL:</p>
<pre><code>http://localhost:8080/OSLC4JBugzilla/services/1/changeRequests
</code></pre>
<p>Our adapter recognizes that you are invoking the Creation Factory (instead of requesting a listing of bugs) if you request that URL using HTTP POST (instead of GET).  </p>
<h3>Handling BugzillaChangeRequests received via POST</h3><p>In <code>BugzillaChangeRequestService.java</code>, search for the the <code>addChangeRequest()</code> method. Note the JAX-RS annotations:</p>
<pre><code>@POST
@Consumes({OslcMediaType.APPLICATION_RDF_XML, OslcMediaType.APPLICATION_XML, OslcMediaType.APPLICATION_JSON})
@Produces({OslcMediaType.APPLICATION_RDF_XML, OslcMediaType.APPLICATION_XML, OslcMediaType.APPLICATION_JSON})
</code></pre>
<p>The <code>@Consumes</code> annotation indicates that the method accepts a <strong>BugzillaChangeRequest</strong> in RDF/XML, XML, or JSON format; the <code>@Produces</code> annotation indicates that it will return the same.</p>
<p>The following code in the <code>addChangeRequest()</code> method creates a new Bugzilla bug from an OSLC <strong>BugzillaChangeRequest</strong> object (using the previously discussed <code>createBug()</code> method)::</p>
<pre><code>final String newBugId = BugzillaManager.createBug(httpServletRequest,
                        changeRequest, productId);     
</code></pre>
<p>Next, we convert the bug into a <strong>BugzillaChangeRequest</strong>:</p>
<pre><code>final Bug newBug = BugzillaManager.getBugById(httpServletRequest,
                   newBugId);
    
BugzillaChangeRequest newChangeRequest;

try {
  newChangeRequest = BugzillaChangeRequest.fromBug(newBug);
} catch (Exception e) {
  throw new WebApplicationException(e);
}
</code></pre>
<p>Then we return the new <strong>BugzillaChangeRequest</strong> as the body of a POST response:</p>
<pre><code>URI about = getAboutURI(productId + &quot;/changeRequests/&quot; + newChangeRequest.getIdentifier());
newChangeRequest.setServiceProvider(
  ServiceProviderCatalogSingleton.getServiceProvider(httpServletRequest, productId).getAbout());
newChangeRequest.setAbout(about);
setETagHeader(getETagFromChangeRequest(newChangeRequest), httpServletResponse);

return Response.created(about).entity(changeRequest).build();
</code></pre>
<p>Note that we set the <code>Location</code> header (via <code>Response.created()</code>) to the <code>about</code> URI for the new <strong>BugzillaChangeRequest</strong>; this is a SHOULD requirement of <a href="http://open-services.net/bin/view/Main/OslcCoreSpecification#Creation_Factories">the Core specification</a>.</p>
<h3>Try it out!</h3><p>If you can create new bugs on your Bugzilla application, you should be able to create a bug via HTTP to our adapter.</p>
<ol>
<li><p>In Firefox or Chrome, open the <strong>Poster</strong> plugin.</p>
</li>
<li><p>In the <strong>URL</strong> field, type the URL for the Creation Factory (replace {ProductID} with a valid ID for a Bugzilla product):</p>
<pre><code> http://oslc:8080/OSLC4JBugzilla/services/1/changeRequests
</code></pre>
</li>
<li><p>In the <strong>User Auth</strong> fields, type your Bugzilla username and password.</p>
</li>
<li><p>On the <strong>Headers</strong> tab, for the <strong>Name</strong> type <code>Content-Type</code> and for the <strong>Value</strong> type <code>application/rdf+xml</code></p>
</li>
<li><p>In the <strong>Body</strong> field enter the following example RDF/XML content. Change <code>you@example.com</code> to reflect your Bugzilla login/email; you might have to change some values depending on how your Bugzilla product has been configured, specifically <code>bugz:operatingSystem</code> and <code>bugz:component</code>.</p>
<pre><code>  &lt;rdf:RDF
    xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;
    xmlns:oslc=&quot;http://open-services.net/ns/core#&quot;
    xmlns:bugz=&quot;http://www.bugzilla.org/rdf#&quot;
    xmlns:foaf=&quot;http://xmlns.com/foaf/0.1/&quot;
    xmlns:dcterms=&quot;http://purl.org/dc/terms/&quot;
    xmlns:oslc_cm=&quot;http://open-services.net/ns/cm#&quot;&gt;

    &lt;oslc_cm:ChangeRequest&gt;
      &lt;bugz:operatingSystem&gt;Linux&lt;/bugz:operatingSystem&gt;
      &lt;rdf:type rdf:resource=&quot;http://open-services.net/ns/cm#BugzillaChangeRequest&quot;/&gt;
      &lt;oslc_cm:status&gt;NEW&lt;/oslc_cm:status&gt;
      &lt;bugz:priority&gt;---&lt;/bugz:priority&gt;
      &lt;dcterms:title&gt;New bug entered from OSLC Adapter&lt;/dcterms:title&gt;
      &lt;bugz:version&gt;unspecified&lt;/bugz:version&gt;
      &lt;bugz:platform&gt;PC&lt;/bugz:platform&gt;
      &lt;dcterms:contributor&gt;
        &lt;foaf:Person rdf:about=&quot;http://oslc:8080/OSLC4JBugzilla/person?mbox=you%40example.com&quot;&gt;
          &lt;foaf:mbox&gt;you@example.com&lt;/foaf:mbox&gt;
        &lt;/foaf:Person&gt;
      &lt;/dcterms:contributor&gt;
      &lt;bugz:component&gt;Server&lt;/bugz:component&gt;
      &lt;oslc_cm:severity&gt;Unclassified&lt;/oslc_cm:severity&gt;
    &lt;/oslc_cm:ChangeRequest&gt;
  &lt;/rdf:RDF&gt;
</code></pre>
</li>
<li><p>Click <strong>Post</strong> to execute the HTTP POST method. You should receive a <strong>201 Created</strong> status header and the response body should contain the RDF/XML <strong>BugzillaChangeRequest</strong> representation of the new bug.</p>
</li>
</ol>
<h2>Providing a ResourceShape document</h2><p>To make it possible for client programs to automatically determine which BugzillaChangeRequest fields are required and the allowed values for those fields, we should provide a <a href="https://open-services.net/resources/oslc-primer/#resourceshapes">Resource Shape</a> for every creation factory.</p>
<p><a href="http://archive.open-services.net/bin/view/Main/OslcCoreSpecification?sortcol=table;table=up#Overview">Resource Shapes</a> are descriptive documents that define the set of OSLC Properties expected in a resource for specific operations (i.e. creation, update or query) along with the value types, allowed values, cardinality and optionality of each OSLC property. A client can use this information when creating new resources.</p>
<p>Fortunately, OSLC4J automates the creation of Resource Shape documents from our existing description of a <strong>BugzillaChangeRequest</strong>. All we must do is declare the location in our <code>@OslcCreationFactory</code> annotation:</p>
<pre><code>resourceShapes = {OslcConstants.PATH_RESOURCE_SHAPES + &quot;/&quot; + Constants.PATH_CHANGE_REQUEST}
</code></pre>
<p>Which indicates the resource shape will be located at the URI <code>resourceShapes/changeRequest</code>. For example if your Bugzilla adapter is running at <code>localhost:8080</code>, the Resource Shape will be available at this URL:</p>
<pre><code>http://localhost:8080/OSLC4JBugzilla/services/resourceShapes/changeRequest
</code></pre>
<p>You can open <a href="http://localhost:8080/OSLC4JBugzilla/services/resourceShapes/changeRequest">http://localhost:8080/OSLC4JBugzilla/services/resourceShapes/changeRequest</a> in a browser to view the Resource Shape as an RDF/XML document. You can also use Postman, Insomnia, or another REST client with an <code>Accept</code> header of <code>application/json</code> to retrieve it in JSON format.</p>
<p>Note that the document includes not only OSLC CM properties such as <code>relatedChangeRequest</code> or <code>inprogress</code>, but also Bugzilla-specific properties like <code>priority</code> and <code>version</code>; this indicates it was assembled from our <strong>BugzillaChangeRequest</strong> class.</p>
<p>Because these documents are not really meant to be human-readable, you don&#39;t have to build a HTML representation in a JSP template as we have for other resources.</p>
<h2>Wrapping up</h2><p>Our Bugzilla adapter now allows Bugzilla to be a reasonably complete OSLC CM provider application. In the next section, we&#39;ll take a different application (NinaCRM) and extend it to be an OSLC consumer that can take advantage of all the work we&#39;ve done here.</p>
<p><a href="../integrating_with_an_oslc_provider/2_0_implementing_consumer">Next: Part 2, Implementing Consumer</a></p>
</div></section></div><a role="button" aria-label="Toggle Navigation" data-toggle-class="primary-nav-is-open" data-toggle-target="body" class="close-off-canvas"></a></main></div><footer class="footer"><p>Content licensed under <a href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 US</a> | <a href="https://github.com/OSLC/developing-oslc-applications/edit/gh-pages/_harp/integrating_products_with_oslc/implementing_an_oslc_provider/1_7_factory.md" target="_blank" style="font-weight: bold"><i class="fas fa-pencil-alt"></i> Edit this page</a> | <a href="https://github.com/OSLC/developing-oslc-applications/issues">Report an issue</a> | <a href="https://open-services.net/" target="_blank">Open Services for Lifecycle Collaboration</a> <i class="fas fa-external-link-alt"></i></p></footer></body><script>window.site_url = 'https://oslc.github.io/developing-oslc-applications/';</script><script src="https://oslc.github.io/developing-oslc-applications/js/oslc.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ER4THK2G7V"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ER4THK2G7V', {'anonymize_ip' : true, 'client_storage': 'none'});</script></html>